<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
    <head>
        <meta charset="UTF-8">
        <title>新NISA資産形成シミュレーション</title>
        <link rel="stylesheet" th:href="@{/bootstrap.min.css}">
        <script type="text/javascript" th:src="@{/jquery-3.7.0.min.js}"></script>
        <script type="text/javascript" th:src="@{/bootstrap.min.js}"></script>
        <link rel="stylesheet" th:href="@{/home.css}">
    </head>
    <body>
        <div class="container">
            <div class="head">
                <h1>新NISA資産形成シミュレーション</h1>
            </div>
            <div class="contents">
                <form action="/add">
                    <div class="formContainer">
                        <table>
                            <tr>
                                <th><label>期待収益率(%)</label></th>
                                <td>
                                    <input name="expectedRateOfReturn" class="margin-right" type="text" />
                                    <div th:text="${expectedRateOfReturnError}" class="validColor"></div>
                                </td>
                                <th><label>ボラティリティ(%)</label></th>
                                <td>
                                    <input name="volatility" type="text" />
                                    <div th:text="${volatilityError}" class="validColor"></div>
                                </td>
                            </tr>
                            <tr>
                                <th><label>シミュレーション<br>開始年齢</label></th>
                                <td>
                                    <input name="startAge" class="margin-right" type="text" />
                                    <div th:text="${startAgeError}" class="validColor"></div>
                                </td>
                                <th><label>つみたて月額(万)</label></th>
                                <td>
                                    <input name="monthlySavings" type="text" />
                                    <div th:text="${monthlySavingsError}" class="validColor"></div>
                                </td>
                                <th><label>つみたて額初期値(万)</label></th>
                                <td>
                                    <input name="initialValue" type="text" />
                                    <div th:text="${initialValueError}" class="validColor"></div>
                                </td>
                            </tr>
                            <tr>
                                <th><label>ライフイベント①</label></th>
                                <td><input name="lifeEvent1" class="margin-right" type="text" /></td>
                                <th><label>年齢</label></th>
                                <td>
                                    <input name="lifeEventAge1" class="margin-right" type="text" />
                                    <div th:text="${lifeEventAge1Error}" class="validColor"></div>
                                </td>
                                <th><label>必要資金(万)</label></th>
                                <td>
                                    <input name="requiredFunds1" type="text" />
                                    <div th:text="${requiredFunds1Error}" class="validColor"></div>
                                </td>
                            </tr>
                            <tr>
                                <th><label>ライフイベント②</label></th>
                                <td><input name="lifeEvent2" class="margin-right" type="text" /></td>
                                <th><label>年齢</label></th>
                                <td>
                                    <input name="lifeEventAge2" class="margin-right" type="text" />
                                    <div th:text="${lifeEventAge2Error}" class="validColor"></div>
                                </td>
                                <th><label>必要資金(万)</label></th>
                                <td>
                                    <input name="requiredFunds2" type="text" />
                                    <div th:text="${requiredFunds2Error}" class="validColor"></div>
                                </td>
                            </tr>
                            <tr>
                                <th><label>ライフイベント③</label></th>
                                <td><input name="lifeEvent3" class="margin-right" type="text" /></td>
                                <th><label>年齢</label></th>
                                <td>
                                    <input name="lifeEventAge3" class="margin-right" type="text" />
                                    <div th:text="${lifeEventAge3Error}" class="validColor"></div>
                                </td>
                                <th><label>必要資金(万)</label></th>
                                <td>
                                    <input name="requiredFunds3" type="text" />
                                    <div th:text="${requiredFunds3Error}" class="validColor"></div>
                                </td>
                            </tr>
                            <tr>
                                <th><label>ライフイベント④</label></th>
                                <td><input name="lifeEvent4" class="margin-right" type="text" /></td>
                                <th><label>年齢</label></th>
                                <td>
                                    <input name="lifeEventAge4" class="margin-right" type="text" />
                                    <div th:text="${lifeEventAge4Error}" class="validColor"></div>
                                </td>
                                <th><label>必要資金(万)</label></th>
                                <td>
                                    <input name="requiredFunds4" type="text" />
                                    <div th:text="${requiredFunds4Error}" class="validColor"></div>
                                </td>
                            </tr>
                            <tr>
                                <th><label>ライフイベント⑤</label></th>
                                <td><input name="lifeEvent5" class="margin-right" type="text" /></td>
                                <th><label>年齢</label></th>
                                <td>
                                    <input name="lifeEventAge5" class="margin-right" type="text" />
                                    <div th:text="${lifeEventAge5Error}" class="validColor"></div>
                                </td>
                                <th><label>必要資金(万)</label></th>
                                <td>
                                    <input name="requiredFunds5" type="text" />
                                    <div th:text="${requiredFunds5Error}" class="validColor"></div>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div>
                        <input type="submit" class="button" value="開始" />
                    </div>
                </form>

                <div class="paramList">
                     <table>
                          <thead>
                              <tr>
                                  <th class="hidden">ID</th>
                                  <th>期待収益率</th>
                                  <th>ボラティリティ</th>
                                  <th>シミュレーション開始年齢</th>
                                  <th>つみたて月額</th>
                                  <th>つみたて額初期値</th>
                              </tr>
                          </thead>
                          <tbody>
                              <tr th:each="params : ${params}">
                                  <td class="hidden" th:text="${params.id}"></td>
                                  <td th:text="${params.expectedRateOfReturn} + '%'"></td>
                                  <td th:text="${params.volatility} + '%'"></td>
                                  <td th:text="${params.startAge} + '歳'"></td>
                                  <td th:text="${params.monthlySavings} + '万'"></td>
                                  <td th:text="${params.initialValue} + '万'"></td>
                              </tr>
                          </tbody>
                         <thead>
                             <tr>
                                 <th colspan="5">ライフイベント</th>
                             </tr>
                         </thead>
                         <tbody>
                             <tr th:each="params : ${params}">
                                 <td colspan="5" th:if="${params.lifeEventParams.lifeEventAge1 != 0}" th:text="'・' + ${params.lifeEventParams.lifeEventAge1} + '歳で' + ${params.lifeEventParams.lifeEvent1} + 'のため' + ${params.lifeEventParams.requiredFunds1} + '万円使用'"></td>
                             </tr>
                         </tbody>
                         <tbody>
                             <tr th:each="params : ${params}">
                                 <td colspan="5" th:if="${params.lifeEventParams.lifeEventAge2 != 0}" th:text="'・' + ${params.lifeEventParams.lifeEventAge2} + '歳で' + ${params.lifeEventParams.lifeEvent2} + 'のため' + ${params.lifeEventParams.requiredFunds2} + '万円使用'"></td>
                             </tr>
                         </tbody>
                         <tbody>
                         <tr th:each="params : ${params}">
                             <td colspan="5" th:if="${params.lifeEventParams.lifeEventAge3 != 0}" th:text="'・' + ${params.lifeEventParams.lifeEventAge3} + '歳で' + ${params.lifeEventParams.lifeEvent3} + 'のため' + ${params.lifeEventParams.requiredFunds3} + '万円使用'"></td>
                         </tr>
                         </tbody>
                         <tbody>
                         <tr th:each="params : ${params}">
                             <td colspan="5" th:if="${params.lifeEventParams.lifeEventAge4 != 0}" th:text="'・' + ${params.lifeEventParams.lifeEventAge4} + '歳で' + ${params.lifeEventParams.lifeEvent4} + 'のため' + ${params.lifeEventParams.requiredFunds4} + '万円使用'"></td>
                         </tr>
                         </tbody>
                         <tbody>
                         <tr th:each="params : ${params}">
                             <td colspan="5" th:if="${params.lifeEventParams.lifeEventAge5 != 0}" th:text="'・' + ${params.lifeEventParams.lifeEventAge5} + '歳で' + ${params.lifeEventParams.lifeEvent5} + 'のため' + ${params.lifeEventParams.requiredFunds5} + '万円使用'"></td>
                         </tr>
                         </tbody>
                      </table>
                </div>

                <div  class="chartContainer">
                    <canvas id="myLineChart"></canvas>
                </div>
            </div>
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
        <script th:inline="javascript">
              var ctx = document.getElementById("myLineChart");
              var myLineChart = new Chart(ctx, {
                type: 'line',
                data: {
                  labels: /*[[${monthCountList}]]*/"monthCountList",
                  datasets: [
                    {
                      label: '上位5%',
                      data: /*[[${top5Percent}]]*/"top5Percent",
                      borderColor: '#0099cc',
                      backgroundColor: "rgba(0,0,0,0)"
                    },
                    {
                      label: '予想平均',
                      data: /*[[${expectedAverage}]]*/"expectedAverage",
                      borderColor: '#f8b500',
                      backgroundColor: "rgba(0,0,0,0)"
                    },
                    {
                      label: '下位5%',
                      data: /*[[${bottom5Percent}]]*/"bottom5Percent",
                      borderColor: '#e14024',
                      backgroundColor: "rgba(0,0,0,0)"
                    },
                    {
                      label: '運用なし',
                      data: /*[[${noOperation}]]*/"noOperation",
                      borderColor: '#666c67',
                      backgroundColor: "rgba(0,0,0,0)"
                    }
                  ],
                },
                options: {
                  title: {
                    display: true,
                    text: '資産額推移'
                  },
                  scales: {
                    yAxes: [{
                      ticks: {
                        suggestedMax: /*[[${suggestedMax}]]*/"suggestedMax",
                        suggestedMin: 0,
                        stepSize: /*[[${stepSize}]]*/"stepSize",
                        callback: function(value, index, values){
                          return  value +  '万円'
                        }
                      }
                    }]
                  },
                }
              });
        </script>
    </body>
</html>